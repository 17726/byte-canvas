# Byte Canvas - åœ¨çº¿æ— é™ç”»å¸ƒç¼–è¾‘å™¨

åŸºäº Web çš„é«˜æ€§èƒ½å›¾å½¢ç¼–è¾‘å™¨ã€‚æœ¬é¡¹ç›®é‡‡ç”¨ **"æ¸è¿›å¼æ¶æ„"** ä¸ **"Handler/Service åˆ†å±‚è®¾è®¡"**ï¼Œåœ¨ MVP é˜¶æ®µåˆ©ç”¨ DOM çš„å¸ƒå±€ä¼˜åŠ¿å®ç°äº†ç±»ä¼¼ Figma çš„æ ¸å¿ƒäº¤äº’ä½“éªŒï¼Œå¹¶ä¸ºæœªæ¥è¿ç§» Canvas æ¸²æŸ“é¢„ç•™äº†æ ‡å‡†é€‚é…å™¨æ¥å£ã€‚

## ğŸš€ é¡¹ç›®æ¦‚è¿°

  - **æ ¸å¿ƒç›®æ ‡**: æ„å»ºä¸€ä¸ªæ”¯æŒ 100+ å›¾å…ƒæµç•…äº¤äº’çš„æ— é™ç”»å¸ƒç¼–è¾‘å™¨ã€‚
  - **å½“å‰ç‰ˆæœ¬**: v2.1 (é€»è¾‘å±‚é‡æ„ç‰ˆ)
  - **åœ¨çº¿æ¼”ç¤º**: [ç‚¹å‡»è·³è½¬](https://17726.github.io/byte-canvas/)

### âœ¨ æ ¸å¿ƒäº®ç‚¹

  * **ç”»å¸ƒå¼•æ“**: æ”¯æŒæ— é™ç”»å¸ƒå¹³ç§» (Space+Drag)ã€ç¼©æ”¾ (Ctrl+Wheel) åŠä¸–ç•Œåæ ‡/å±å¹•åæ ‡çš„ç²¾å‡†è½¬æ¢ã€‚
  * **é«˜çº§äº¤äº’**: æ”¯æŒ **8ç‚¹æ‹–æ‹½ç¼©æ”¾**ã€**æ¡†é€‰/ç‚¹é€‰**ã€**å¤šé€‰æ‰¹é‡æ“ä½œ**ã€‚
  * **å¯Œæ–‡æœ¬ç¼–è¾‘**: æ”¯æŒåŒå‡»ç¼–è¾‘ã€éƒ¨åˆ†æ–‡æœ¬æ ·å¼ (BIUS)ã€å­—å·å­—è‰²ä¿®æ”¹ã€‚
  * **æ™ºèƒ½å±æ€§é¢æ¿**: æ”¯æŒ **æ‚¬æµ®å±æ€§æ  (Context Toolbar)** è·Ÿéšé€‰ä¸­å…ƒç´ ï¼Œä»¥åŠå³ä¾§ç²¾å¯†å‚æ•°é¢æ¿çš„åŒå‘ç»‘å®šã€‚

## ğŸ“… é‡Œç¨‹ç¢‘ (Milestones)

### âœ… é˜¶æ®µä¸€ï¼šMVP æ¶æ„éªŒè¯ (å·²å®Œæˆ)

  - [x] **åŸºç¡€æ¶æ„**: Pinia å•å‘æ•°æ®æµ + ToolManager äº‹ä»¶åˆ†å‘
  - [x] **ç”»å¸ƒå¼•æ“**: æ— é™ç”»å¸ƒå¹³ç§»ä¸ç¼©æ”¾ã€åæ ‡ç³»è½¬æ¢
  - [x] **åŸºç¡€å›¾å…ƒ**: çŸ©å½¢ (Rect)ã€åœ†å½¢ (Circle)ã€æ–‡æœ¬ (Text)
  - [x] **æ ¸å¿ƒäº¤äº’**: å•é€‰/æ¡†é€‰ã€æ‹–æ‹½ç§»åŠ¨ã€åˆ é™¤
  - [x] **UI æ¡†æ¶**: æ¥å…¥ Arco Design + IconPark

### ğŸš§ é˜¶æ®µäºŒï¼šåŠŸèƒ½å®Œå–„ä¸äº¤ä»˜ (åŸºæœ¬å®Œæˆ)

  - [x] **å›¾ç‰‡å›¾å…ƒ**: æ”¯æŒå›¾ç‰‡ä¸Šä¼ ã€æ»¤é•œè®¾ç½®ã€æ¯”ä¾‹é”å®š
  - [x] **é«˜çº§å˜å½¢**: 8ç‚¹ç¼©æ”¾ (Resize)ã€Shift ç­‰æ¯”ç¼©æ”¾
  - [x] **å±æ€§é¢æ¿**: æ‚¬æµ®å±æ€§æ  + å³ä¾§å±æ€§é¢æ¿ (åŒå‘ç»‘å®š)
  - [x] **æ•°æ®æŒä¹…åŒ–**: LocalStorage è‡ªåŠ¨ä¿å­˜/æ¢å¤
  - [x] **å¿«æ·é”®ç³»ç»Ÿ**: å®Œå–„å¿«æ·é”®æ”¯æŒ (Copy/Paste/Group)

### ğŸ—“ï¸ é˜¶æ®µä¸‰ï¼šè¿›é˜¶æŒ‘æˆ˜ (12.12 Deadline)

  - [x] **ç»„åˆç³»ç»Ÿ**: æˆç»„ (Group) / è§£ç»„ (Ungroup) / ç»„å†…ç©¿é€é€‰æ‹©
  - [ ] **å†å²è®°å½•**: æ’¤é”€ (Undo) / é‡åš (Redo) æ ˆ
  - [ ] **æ€§èƒ½ä¼˜åŒ–**: é’ˆå¯¹å¤§é‡å›¾å…ƒçš„æ¸²æŸ“ä¼˜åŒ–
  - [ ] **è¾…åŠ©åŠŸèƒ½**: å¸é™„å¯¹é½ã€æ ‡å°º

## ğŸ— ç³»ç»Ÿæ¶æ„ (Architecture)

æœ¬é¡¹ç›®æ‘’å¼ƒäº†ä¼ ç»Ÿçš„ OOP Node ç»§æ‰¿æ¨¡å¼ï¼Œé‡‡ç”¨äº† **"Handler/Service åˆ†å±‚æ¶æ„"** é…åˆ **"æ¸²æŸ“é€‚é…å™¨æ¨¡å¼"**ï¼Œå®ç°äº†è§†å›¾ã€é€»è¾‘ã€æ•°æ®ä¸æ¸²æŸ“çš„å½»åº•è§£è€¦ã€‚

#### æ ¸å¿ƒåˆ†å±‚è§†å›¾ (Layered View)

æˆ‘ä»¬å°†ç³»ç»Ÿè‡ªä¸Šè€Œä¸‹åˆ’åˆ†ä¸ºäº”ä¸ªæ ¸å¿ƒå±‚çº§ï¼š

* **L1 è§†å›¾å±‚ (View Layer)**
    * **è½½ä½“**: Vue ç»„ä»¶ (`src/components`)
    * **èŒè´£**: **åªè´Ÿè´£â€œå±•ç¤ºâ€å’Œâ€œç›‘å¬â€**ã€‚å®ƒä¸å¤„ç†ä»»ä½•ä¸šåŠ¡é€»è¾‘ï¼Œä»…å°† DOM äº‹ä»¶ï¼ˆé¼ æ ‡ã€é”®ç›˜ï¼‰åŸå°ä¸åŠ¨åœ°è½¬å‘ç»™ä¸‹ä¸€å±‚ã€‚
    * *å…³é”®ç»„ä»¶:* `CanvasStage` (ç”»å¸ƒå®¹å™¨), `CanvasToolbar` (å·¥å…·æ ), `PropertyPanel` (å±æ€§é¢æ¿)ã€‚

* **L2 äº¤äº’å±‚ (Interaction Layer)**
    * **è½½ä½“**: `ToolManager` + `Handlers` (`src/core/handlers`)
    * **èŒè´£**: **è´Ÿè´£â€œæ€ä¹ˆæ“ä½œâ€**ã€‚ç»´æŠ¤äº¤äº’è¿‡ç¨‹ä¸­çš„ä¸´æ—¶çŠ¶æ€ï¼ˆå¦‚æ‹–æ‹½ä¸­çš„ `isDragging`ã€èµ·å§‹åæ ‡ `startPos`ï¼‰ã€‚
    * *æ ¸å¿ƒæ¨¡å—:*
        * `ToolManager`: **ä¸­å¤®äº‹ä»¶æ€»çº¿**ï¼Œè´Ÿè´£è·¯ç”±äº‹ä»¶ã€‚
        * `TransformHandler`: å¤„ç†èŠ‚ç‚¹çš„æ‹–æ‹½ä¸ 8 ç‚¹ç¼©æ”¾ã€‚
        * `SelectionHandler`: å¤„ç†ç‚¹å‡»é€‰ä¸­ä¸æ¡†é€‰è®¡ç®—ã€‚

* **L3 ä¸šåŠ¡å±‚ (Service Layer)**
    * **è½½ä½“**: `Services` (`src/core/services`)
    * **èŒè´£**: **è´Ÿè´£â€œåšä»€ä¹ˆâ€**ã€‚å°è£…æ— çŠ¶æ€çš„åŸå­ä¸šåŠ¡é€»è¾‘ï¼Œä¾› UI æˆ–äº¤äº’å±‚è°ƒç”¨ã€‚
    * *æ ¸å¿ƒæœåŠ¡:*
        * `NodeFactory`: **èŠ‚ç‚¹å·¥å‚**ï¼Œç”Ÿäº§æ ‡å‡†åŒ–çš„å›¾å½¢æ•°æ®ç»“æ„ã€‚
        * `GroupService`: **ç»„åˆæœåŠ¡**ï¼Œå¤„ç†æˆç»„/è§£ç»„åŠçˆ¶å­èŠ‚ç‚¹åæ ‡è½¬æ¢ã€‚

* **L4 æ¸²æŸ“å±‚ (Rendering Layer)**
    * **è½½ä½“**: `Renderers` (`src/core/renderers`)
    * **èŒè´£**: **è´Ÿè´£â€œé•¿ä»€ä¹ˆæ ·â€**ã€‚å°†çº¯æ•°æ®ç¿»è¯‘ä¸ºå±å¹•ä¸Šçš„åƒç´ æˆ– DOM å…ƒç´ ã€‚
    * *è®¾è®¡æ¨¡å¼:* **ç­–ç•¥æ¨¡å¼ (Adapter Pattern)**ã€‚é€šè¿‡ `INodeRenderer` æ¥å£å±è”½åº•å±‚å·®å¼‚ã€‚
        * `DomRenderer`: (å½“å‰ MVP) å°† Node æ•°æ®æ˜ å°„ä¸º CSS å±æ€§ã€‚
        * `CanvasRenderer`: (æœªæ¥æ‰©å±•) å°† Node æ•°æ®æ˜ å°„ä¸º Canvas ç»˜å›¾æŒ‡ä»¤ã€‚

* **L5 æ•°æ®å±‚ (Model Layer)**
    * **è½½ä½“**: Pinia Store (`src/store`)
    * **èŒè´£**: **å•ä¸€ä¿¡æº (Single Source of Truth)**ã€‚
    * è´Ÿè´£å­˜å‚¨æ‰å¹³åŒ–çš„èŠ‚ç‚¹æ ‘ç»“æ„ (`nodes`) å’Œæ¸²æŸ“é¡ºåº (`nodeOrder`)ã€‚
    * è´Ÿè´£æ•°æ®çš„æŒä¹…åŒ– (LocalStorage) ä¸å˜æ›´é€šçŸ¥ (`version++`)ã€‚

---

#### æ•°æ®æµå‘å›¾ (Data Flow)

1.  **äº¤äº’æµ**: `View` (äº‹ä»¶) â†’ `Interaction` (è®¡ç®—æ„å›¾) â†’ `Service` (æ‰§è¡Œé€»è¾‘) â†’ `Store` (æ›´æ–°æ•°æ®)
2.  **æ¸²æŸ“æµ**: `Store` (æ•°æ®å˜æ›´) â†’ `View` (å“åº”å¼æ›´æ–°) â†’ `Rendering` (è®¡ç®—æ ·å¼) â†’ `DOM/Canvas` (ç»˜åˆ¶)

---

## ğŸ“‚ ç›®å½•ç»“æ„

```text
src/
â”œâ”€â”€ core/                     # [æ ¸å¿ƒé€»è¾‘å±‚]
â”‚   â”œâ”€â”€ ToolManager.ts        # äº‹ä»¶åˆ†å‘ä¸­å¿ƒ (Event Dispatcher)
â”‚   â”œâ”€â”€ handlers/             # [äº¤äº’å¤„ç†å™¨] å¤„ç†æ‹–æ‹½ã€ç¼©æ”¾ã€æ¡†é€‰ç­‰æœ‰çŠ¶æ€äº¤äº’
â”‚   â”œâ”€â”€ services/             # [ä¸šåŠ¡æœåŠ¡] èŠ‚ç‚¹å·¥å‚ã€ç»„åˆé€»è¾‘ç­‰æ— çŠ¶æ€æœåŠ¡
â”‚   â”œâ”€â”€ renderers/            # [æ¸²æŸ“é€‚é…å™¨] DomRectRenderer, DomTextRenderer...
â”‚   â””â”€â”€ utils/                # [åŸºå»º] çº¯æ•°å­¦å·¥å…· (geometry.ts)
â”œâ”€â”€ store/                    # [æ•°æ®å±‚] Pinia (canvasStore, uiStore)
â”œâ”€â”€ components/               # [è§†å›¾å±‚]
â”‚   â”œâ”€â”€ editor/               # ç”»å¸ƒæ ¸å¿ƒ (CanvasStage, Layers)
â”‚   â””â”€â”€ layout/               # ç•Œé¢å¸ƒå±€ (Toolbar, PropertyPanel)
â””â”€â”€ types/                    # [ç±»å‹å®šä¹‰] BaseNodeState, NodeState
```

## ğŸ“¦ å¼€å‘æŒ‡å—

### ç¯å¢ƒè¦æ±‚

  - Node.js \>= 18.0.0
  - pnpm / npm

### å¿«é€Ÿå¼€å§‹

```sh
# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# ç±»å‹æ£€æŸ¥
npm run type-check
```

## ğŸ“ åä½œè§„èŒƒ

  * **åˆ†æ”¯ç®¡ç†**: ç¦æ­¢ç›´æ¥ Push `main`ã€‚æ‰€æœ‰åŠŸèƒ½å¼€å‘éœ€åˆ‡å‡º `feat/name/feature` åˆ†æ”¯ã€‚
  * **æäº¤è§„èŒƒ**: éµå¾ª Conventional Commits (`feat:`, `fix:`, `refactor:`).
  * **ä»£ç é£æ ¼**: å¼ºæ ¡éªŒ ESLint + Prettierã€‚
  * **Code Review**: æ ¸å¿ƒé€»è¾‘ä¿®æ”¹éœ€ç»è¿‡ Module Guardian (æ¨¡å—è´Ÿè´£äºº) å®¡æŸ¥ã€‚